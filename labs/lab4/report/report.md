---
## Front matter
title: "Отчёт по лабораторной работе №4"
subtitle: "Вариант 2"
author: "Акондзо Жордани Лади Гаэл"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage[T2B]{fontenc}
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# I.Цель работы

Постройте фазовый портрет гармонического осциллятора и решение уравнения
гармонического осциллятора

# II.Задание

Постройте фазовый портрет гармонического осциллятора и решение уравнения гармонического осциллятора для следующих случаев.

1. Колебания гармонического осциллятора без затуханий и без действий внешней силы $\ddot{x}+5x=0$

2. Колебания гармонического осциллятора c затуханием и без действий внешней силы $\ddot{x}+2\dot{x}+5x=0$

3. Колебания гармонического осциллятора c затуханием и под действием внешней силы $\ddot{x}+4\dot{x}+x=5sin(14t)$

На интервале $t=[0;30]$ (шаг 0.05) с начальными условиями $x_{0}=0, y_{0}=1$

# III. Выполнение задания

## 1. Колебания гармонического осциллятора без затуханий и без действий внешней силы 

**Уравнение:**
`$\ddot{x} + 5x = 0$`

Это стандартное уравнение гармонического осциллятора, где $x$ представляет смещение от равновесия, а $\ddot{x}$ - ускорение. Коэффициент 5 соответствует квадрату собственной частоты осциллятора (ω²).

**Решение:**
- Уравнение является линейным дифференциальным уравнением второго порядка с постоянными коэффициентами.
- Характеристическое уравнение имеет вид $\lambda^2 + 5 = 0$, корни которого $\lambda = \pm i\sqrt{5}$.
- Общее решение уравнения будет комбинацией функций $\sin(\sqrt{5}t)$ и $\cos(\sqrt{5}t)$.


### Реализация в Julia

Для решения данного уравнения в Julia, мы сначала преобразуем его в систему двух уравнений первого порядка, введя новую переменную $v = \dot{x}$, что позволит нам использовать стандартные методы для систем ОДУ.

* Построить фазовый портрет гармонического осциллятора с помощью Julia (рис. [-@fig:001]).

Введём следующий код:
```julia
using DifferentialEquations
using Plots

# Определение системы ОДУ для первого случая
# Колебания гармонического осциллятора без затухания и без действия внешней силы
function harmonic_oscillator_1(du, u, p, t)
    x, v = u  # u[1] это положение x, u[2] это скорость v
    du[1] = v             # dx/dt = v
    du[2] = -5*x          # dv/dt = -5x (без затухания, без внешней силы)
end

# Начальные условия и интервал времени
u0 = [0.0, 1.0]          # x0 = 0, v0 = 1
tspan = (0.0, 30.0)      # От t = 0 до t = 30
dt = 0.05                # Шаг времени для сохранения результатов

# Создание проблемы ОДУ
prob1 = ODEProblem(harmonic_oscillator_1, u0, tspan)

# Решение проблемы ОДУ
sol1 = solve(prob1, saveat=dt)

# Построение фазового портрета
plot(sol1, idxs=(1,2), xlabel="Положение (x)", ylabel="Скорость (v)", title="Фазовый портрет гармонического осциллятора 1")
```
И мы получим результат:

![Фазовый портрет гармонического осциллятора 1](https://drive.google.com/uc?id=1HcXmvNS_8jPlAYqpaprOYzt11UT2Fo5X){#fig:001 width=70%}

## 2. Колебания гармонического осциллятора c затуханием и без действий внешней силы

**Уравнение:**
`$\ddot{x} + 2\dot{x} + 5x = 0$`

Здесь добавляется член затухания $2\dot{x}$, который пропорционален и противоположен скорости, моделирующий силу трения или сопротивления.

**Решение:**
- Введем затухание $b = 2$ и собственную частоту $\omega_0^2 = 5$.
- Характеристическое уравнение $\lambda^2 + 2\lambda + 5 = 0$ имеет комплексные корни.
- Решение будет включать экспоненциально затухающие термины $e^{-t}$, модифицированные синусоидальными и косинусоидальными функциями.

### Реализация в Julia :

- Мы сначала преобразуем это уравнение второго порядка в систему первого порядка, введя $v = \dot{x}$.
- Это дает нам два уравнения: $\dot{x} = v$ и $\dot{v} = -2v - 5x$.
- Мы используем функцию `ODEProblem` для определения задачи решения ОДУ с начальными условиями $x_0 = 0, v_0 = 1$.
- Затем мы решаем эту задачу с помощью функции `solve`, указывая интервал времени и шаг сохранения результатов.
- Результаты решения используются для построения фазового портрета, показывающего зависимость скорости от положения.

* Построить фазовый портрет гармонического осциллятора с помощью Julia (рис. [-@fig:002]).

Введём следующий код:
```julia

using DifferentialEquations
using Plots

# Определение системы ОДУ для второго случая
# Колебания гармонического осциллятора с затуханием и без действия внешней силы
function harmonic_oscillator_2(du, u, p, t)
    x, v = u  # u[1] это положение x, u[2] это скорость v
    du[1] = v             # dx/dt = v, первое уравнение системы
    du[2] = -2*v - 5*x    # dv/dt = -2v - 5x, второе уравнение системы с затуханием
end

# Начальные условия и интервал времени
u0 = [0.0, 1.0]          # x0 = 0, v0 = 1, начальное положение и начальная скорость
tspan = (0.0, 30.0)      # От t = 0 до t = 30, временной интервал для решения ОДУ
dt = 0.05                # Шаг времени для сохранения результатов

# Создание проблемы ОДУ для решения
prob2 = ODEProblem(harmonic_oscillator_2, u0, tspan)

# Решение проблемы ОДУ
sol2 = solve(prob2, saveat=dt)

# Построение фазового портрета
plot(sol2, idxs=(1,2), xlabel="Положение (x)", ylabel="Скорость (v)", title="Фазовый портрет гармонического осциллятора 2")

```
И мы получим результат:

![Фазовый портрет гармонического осциллятора 2](https://drive.google.com/uc?id=1lDJncGWR8ODxKtc-iBlrTzW6JaomF3qx){#fig:002 width=70%}

## 3. Колебания гармонического осциллятора c затуханием и под действием внешней силы

**Уравнение:**
`$\ddot{x} + 4\dot{x} + x = \sin(14t)$`

Теперь система испытывает действие внешней силы, моделируемой функцией $\sin(14t)$, которая заставляет систему колебаться с внешней частотой.

**Решение:**
- Дифференциальное уравнение включает неоднородный член $\sin(14t)$, указывающий на наличие внешнего возмущения.
- Ответ будет состоять из двух частей: одна соответствует свободным (натуральным) колебаниям системы, а другая - вынужденным колебаниям из-за внешней силы.
- Вынужденная часть ответа будет иметь ту же частоту, что и внешняя сила.

### Реализация в Julia : 

- Аналогично предыдущим случаям, мы преобразуем уравнение в систему первого порядка.
- Вводим функцию в правой части уравнения для описания внешней силы: $f(t) = \sin(14t)$.
- Определяем систему уравнений: $\dot{x} = v$ и $\dot{v} = -4v - x + f(t)$.
- Решаем систему уравнений, используя `ODEProblem` и `solve` с теми же начальными условиями и временным интервалом.
- Фазовый портрет строится по решению, иллюстрируя динамику системы под воздействием внешней силы.

* Построить фазовый портрет гармонического осциллятора с помощью Julia (рис. [-@fig:003]).

Введём следующий код:
```julia

using DifferentialEquations
using Plots

# Определение системы ОДУ для третьего случая
# Колебания гармонического осциллятора с затуханием и под действием внешней силы
function harmonic_oscillator_3(du, u, p, t)
    x, v = u  # u[1] это положение x, u[2] это скорость v
    du[1] = v                          # dx/dt = v, первое уравнение системы
    du[2] = -4*v - x + sin(14*t)       # dv/dt = -4v - x + sin(14t), второе уравнение системы с затуханием и внешней силой
end

# Начальные условия и интервал времени
u0 = [0.0, 1.0]         # x0 = 0, v0 = 1, начальное положение и начальная скорость
tspan = (0.0, 30.0)     # От t = 0 до t = 30, временной интервал для решения ОДУ
dt = 0.05               # Шаг времени для сохранения результатов

# Создание проблемы ОДУ для решения
prob3 = ODEProblem(harmonic_oscillator_3, u0, tspan)

# Решение проблемы ОДУ
sol3 = solve(prob3, saveat=dt)

# Построение фазового портрета
plot(sol3, idxs=(1,2), xlabel="Положение (x)", ylabel="Скорость (v)", title="Фазовый портрет гармонического осциллятора 3")
```
И мы получим результат:

![Фазовый портрет гармонического осциллятора 3](https://drive.google.com/uc?id=10stq3JbSP7A2kqbFBgMtphwLVYBeGtjW){#fig:003 width=70%}


# IV. Вывод

В ходе выполнения лабораторной работы я научился строить фазовый портрет гармонического осциллятора и решать уравнения гармонического осциллятора.

# V. Ответы на вопросы : 

1.Простейшим видом колебательного процесса являются простые гармонические колебания, описывающиеся уравнением: $$ x = x_m cos (ωt + φ_0) $$
где x — смещение тела от положения равновесия, x_m — амплитуда колебаний, ω — циклическая или круговая частота, t — время.

2.Осциллятор — система, совершающая колебания, то есть показатели которой периодически повторяются во времени.

Модель математического маятника $$ \frac{d^2\alpha}{d t^2}+\frac{g}{L}\alpha=0 или \frac{d^2\alpha}{dt^2}+\omega^2\alpha=0 $$
4.Дифференциальное уравнение второго порядка: $$ \ddot{x}+w_0^2x=f(t) $$ Замена: $$ y=\dot{x} $$ Полученная система уравнений: $$ y =\dot{x};\dot{y}=-w_0^2x $$

5.Фазовый портрет — это полная совокупность различных фазовых траекторий.

Фазовая траектория — кривая в фазовом пространстве, составленная из точек, представляющих состояние динамической системы в последовательные моменты времени в течение всего времени эволюции.